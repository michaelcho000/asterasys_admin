# 시술 예약 전환 퍼널 카드 – 리디자인 화면 구성안

- 작성일: 2025-09-30
- 대상 페이지: `/marketing-insights`
- 목적: 실제 마케팅 인사이트(월별 실측 리드/예약/시술 데이터를 기반)와 경쟁사 비교를 한 카드 안에서 직관적으로 전달.
- 전제: 코딩 이전의 화면 설계. 모든 UI는 Duralux 컴포넌트 재사용, 새로운 컴포넌트 생성 금지.

---

## 데이터 소스 & 파이프라인

| 단계 | 자사 데이터 (실측) | 경쟁사 데이터 | 설명 |
| --- | --- | --- | --- |
| 검색/노출 | `data/raw/2025-08/asterasys_total_data - traffic.csv` (키워드별 월간 검색량) | 동일 CSV에서 경쟁사 제품(덴서티·세르프·올리지오·볼뉴머·텐써마) 추출 | 검색량은 실측. 크롤링 기준 컬럼: `키워드`, `월간 검색량`. |
| 방문 → 문의 | (신규) `data/processed/2025-08/funnel.json` 또는 CRM 연동 API에서 `visits`, `inquiries` | 직접 데이터 부족 시 카페 참여(views/comments) 기반 추정. 추정치에는 `estimated` 플래그 부여. | 실측 이벤트 존재 시 우선. 없으면 추정 값은 별도 표시. |
| 문의 → 예약 | 동일 `funnel.json` (`bookings`) | 경쟁사 판매/입점 지표(`sale.csv`, `cafe_rank.csv`)로 추정. | 예약 데이터가 실측일 경우 추정치 대신 실제 사용. |
| 예약 → 시술 결정 | 병원 파트너 CRM `procedures` or `accepted` | 경쟁사 판매(`sale.csv`) 합계로 기준선 계산. | 자사 데이터 없으면 N/A 처리, 벤치마크만 표기. |
| 컨텍스트 | `data/processed/2025-08/dashboard.json`, `kpis.json` | 동일 | 보조 지표(블로그 발행/카페 조회 등). |

데이터 처리 원칙
- 실측(Event 기반) > 공식 집계(JSON) > CSV 추정. 각 단계에 사용한 데이터 출처를 UI에 노출.
- 추정치 사용 시 “추정” 배지와 근거(예: 카페 조회/포스트) 병기.
- 정규화(10,000 검색 가정)는 QA용으로만 사용, UI 노출 금지.

---

## 화면 레이아웃 개요

```
┌───────────────────────────────────────────────────────────────┐
│ [헤더] 제목, 월 선택, 제품 탭 (리프테라/쿨소닉/쿨페이즈/합산) │
├───────────────────────────────────────────────────────────────┤
│ Row 1 │ 좌: 자사 퍼널 KPI 카드 (실측 전환율 + 단계별 절대치)  │
│       │ 우: 단계별 진행률 & 구간별 추세 미니 차트             │
├───────────────────────────────────────────────────────────────┤
│ Row 2 │ 좌: 병목 단계 인사이트 카드 (RCI/SAI, 개선 제안)       │
│       │ 우: 경쟁사 5종 단계별 매트릭스 (전환률 & 검색량)       │
├───────────────────────────────────────────────────────────────┤
│ Row 3 │ 비교 탭(시장 평균 vs 경쟁사 평균 vs 자사), 데이터 출처 │
│       │ + 필터(추정치 표기 토글, 절대값/비율 전환)            │
└───────────────────────────────────────────────────────────────┘
```

---

## 섹션별 상세 구성

### 1. 헤더 영역
- `card-header` 구성
  - 좌측: `h5` 제목 “시술 예약 전환 퍼널 (검색 → 시술 결정)”
  - 하단 소제목: 선택 월/주/기간. 예: “2025년 8월 실측 + 추정 보조”
  - 우측 컨트롤
    - 기간 선택(`select`): 월별
    - 제품 토글(`btn-group`): 리프테라 / 쿨소닉 / 쿨페이즈 / 합산
    - 추정치 표시 토글(`form-switch`): “추정 단계 포함”
    - 툴팁 버튼: 데이터 출처 & 정규화 정책

### 2. 자사 퍼널 KPI 카드 (Row 1, Left)
- 컴포넌트: `.card` 내부 `row` 분할
- 핵심 요소
  1. 최종 전환율(실측 또는 추정) – `display-5`, 색상 `text-primary`
     - 하단 배지: “실측” 또는 “추정” + 출처 (예: CRM vs traffic+cafe)
  2. 단계별 절대치
     - 검색량, 방문, 문의, 예약, 시술 결정 수치를 `list-group` 형식으로, 전월 대비 증감 표시(+/- %)
  3. 병목 강조
     - SAI 최저 단계 표시(빨간 `badge`) + 예상 개선 효과 (감도 분석)

### 3. 단계별 진행률 & 미니 추세 (Row 1, Right)
- 구성: 각 단계별 카드 4개(방문/문의/예약/시술 결정)
  - 상단: 단계명 + 전환율(%) + 추정 여부 구분
  - 중간: `HorizontalProgress`로 비율 시각화
  - 하단: 일/주 단위 시계열 미니 Sparkline (`apex-line` 재사용) – 데이터는 `funnel_trend.json` (신규)에서 가져옴. 없으면 표시 생략.

### 4. 병목 단계 인사이트 카드 (Row 2, Left)
- 내용
  - RCI(자사 vs 경쟁사 최종 전환) 게이지: `CircularProgress` 또는 수평 바(70% 기준)
  - SAI 단계별 바 차트: RCI <1인 단계 빨간색
  - 추천 액션 2~3개 자동 생성(예: “쿨소닉: 참여/포스트 8.7 – CTA 고정 배치로 방문→문의 +0.6%p 목표”)
- 데이터: RCI/SAI는 전 단계 계산값, 추천 액션 문구는 `insights` 배열에서 동적 생성

### 5. 경쟁사 5종 매트릭스 (Row 2, Right)
- 테이블 레이아웃
  - 열: 제품, 검색량, 방문→문의, 문의→예약, 예약→시술, 최종 전환율
  - 행: 덴서티, 세르프, 올리지오, 볼뉴머, 텐써마
  - `badge`로 상위/하위 단계 강조
- 그래프
  - 맨 아래에 전환율 Heatmap (`table` + 배경 색상) 또는 `apex-heatmap`
- 출처
  - 검색량: traffic.csv, 추정 전환율은 카페/판매 지표로 역산, 추정 배지 필수

### 6. 비교 탭 & 데이터 출처 (Row 3)
- 탭 구성 (`nav-tabs`)
  - `자사 vs 경쟁사`, `시장 평균`, `추세 비교`
- 자사 vs 경쟁사 탭
  - 3행(자사/경쟁사 평균/시장 평균) × 5열(단계) 표 + 절대/비율 토글
- 시장 평균 탭
  - 벤치마크 그래프(정규화 사용 X) + 범위(최소/최대/중간값)
- 추세 비교 탭
  - 3개월 rolling line chart (최종 전환율)
- 하단 데이터 출처 상자
  - 실측: CRM API / processed JSON
  - 추정: traffic.csv, cafe_rank.csv
  - 비고: “판매 데이터는 병원 채택 참고용”

---

## 인터랙션 & 상태 처리
- 제품 토글 → 단계별 데이터/인사이트 모두 갱신
- 추정치 숨기기 → 추정 단계는 회색 처리 + 값 숨김 → “추정치 없음” 메시지
- 데이터 없음(N/A) → 카드 하단에 “데이터 연결 필요” 링크(설정 페이지 이동)
- 로딩 상태 → 스켈레톤(탭별 4개 progress skeleton + 테이블 placeholder)

---

## 인사이트 생성 로직 (비주얼 정책)
- 병목 단계 선정: SAI < 1 중 최저 값
- 권장 액션: 감도 분석(해당 단계 +1%p 시 최종 전환 증분) 기반으로 텍스트 템플릿 자동 채움
- 경쟁사 참고: 경쟁사 중 최상위 전환 단계 -> “OO사는 예약→시술 0.65로 우위” 문구
- 추정 여부 표시: 각 문장 끝에 “(추정)” 라벨

---

## 해야 할 준비 작업 (개발 전)
1. `funnel.json` 또는 CRM API 정의: visits/inquiries/bookings/procedures 실측값 수집
2. `funnel_trend.json` 생성: 단계별 일/주 단위 시계열
3. 경쟁사 전환률 추정 로직 문서화: traffic + cafe + sale 기반 역산 방법 명시
4. CSV 인코딩 교정: UTF-8로 변환하거나 API에서 필드명 매핑
5. QA 체크리스트 문항 업데이트: 추정치 표기, SAI/RCI 검증, 비교표 Δ 계산 정확성 등

---

## 참고: 컴포넌트 매핑
- `Card`, `CardHeader`, `HorizontalProgress`, `CircularProgress`(shared), `Table`, `Badge`
- 미니 차트: 기존 `apex` 래퍼 재사용 (line/sparkline)
- 상태 처리: `CardLoader` or Skeleton 컴포넌트 재사용

---

## 기대 효과
- 실측 전환 데이터(리드→예약→시술) 기반 스토리 전달
- 경쟁사 강·약점 및 병목 단계가 한눈에 보이는 구조
- 추정치와 실측을 명확히 구분하여 신뢰성 향상
- 마케팅 팀이 “어디를 개선해야 하는지” 즉시 판단 가능한 인사이트 카드 완성

